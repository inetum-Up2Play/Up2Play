<form [formGroup]="form" (ngSubmit)="onSubmit()" class="register-form" novalidate>
  <!-- Usuario -->
  <div class="form-field">
    <span class="p-float-label p-input-icon-right full">
      <i class="pi pi-user"></i>
      <input
        pInputText
        id="nombre_usuario"
        formControlName="nombre_usuario"
        autocomplete="username"
        [ngClass]="{'ng-invalid': f.nombre_usuario.invalid && (f.nombre_usuario.dirty || f.nombre_usuario.touched)}"
        class="w-full"
      />
      <label for="nombre_usuario">Usuario</label>
    </span>

    <small class="error" *ngIf="f.nombre_usuario.hasError('required') && (f.nombre_usuario.dirty || f.nombre_usuario.touched)">
      El usuario es obligatorio.
    </small>
    <small class="error" *ngIf="f.nombre_usuario.hasError('minlength') && (f.nombre_usuario.dirty || f.nombre_usuario.touched)">
      Mínimo 3 caracteres.
    </small>
    <small class="error" *ngIf="f.nombre_usuario.hasError('maxlength') && (f.nombre_usuario.dirty || f.nombre_usuario.touched)">
      Máximo 25 caracteres.
    </small>
  </div>

  <!-- Contraseña -->
  <div class="form-field">
    <span class="p-float-label p-input-icon-right full">
      <i class="pi pi-lock"></i>
      <p-password
        inputId="password"
        formControlName="password"
        [feedback]="false"
        [toggleMask]="false"
        [style]="{width: '100%'}"
        [inputStyle]="{width: '100%'}"
        [inputStyleClass]="(f.password.invalid && (f.password.dirty || f.password.touched)) ? 'ng-invalid' : ''"
      ></p-password>
      <label for="password">Contraseña</label>
    </span>

    <small class="hint">
      Debe incluir minúscula, mayúscula, número y símbolo, sin espacios (mín. 8).
    </small>
    <small class="error" *ngIf="f.password.hasError('required') && (f.password.dirty || f.password.touched)">
      La password es obligatoria.
    </small>
    <small class="error" *ngIf="f.password.hasError('minlength') && (f.password.dirty || f.password.touched)">
      Mínimo 8 caracteres.
    </small>
    <small class="error" *ngIf="f.password.hasError('maxlength') && (f.password.dirty || f.password.touched)">
      Máximo 255 caracteres.
    </small>
    <small class="error" *ngIf="f.password.hasError('pattern') && (f.password.dirty || f.password.touched)">
      La password no cumple la política.
    </small>
  </div>

  <!-- Repetir password (justo debajo de usuario, mismo ancho) -->
  <div class="form-field">
    <span class="p-float-label p-input-icon-right full">
      <i class="pi pi-lock"></i>
      <p-password
        inputId="confirmPassword"
        formControlName="confirmPassword"
        [feedback]="false"
        [toggleMask]="false"
        [style]="{width: '100%'}"
        [inputStyle]="{width: '100%'}"
        [inputStyleClass]="(f.confirmPassword.invalid && (f.confirmPassword.dirty || f.confirmPassword.touched)) ? 'ng-invalid' : ''"
      ></p-password>
      <label for="confirmPassword">Repetir password</label>
    </span>

    <small class="error" *ngIf="f.confirmPassword.hasError('required') && (f.confirmPassword.dirty || f.confirmPassword.touched)">
      Este campo es obligatorio.
    </small>
    <small class="error" *ngIf="f.confirmPassword.hasError('minlength') && (f.confirmPassword.dirty || f.confirmPassword.touched)">
      Mínimo 8 caracteres.
    </small>
    <small class="error" *ngIf="f.confirmPassword.hasError('maxlength') && (f.confirmPassword.dirty || f.confirmPassword.touched)">
      Máximo 255 caracteres.
    </small>
    <small class="error" *ngIf="f.confirmPassword.hasError('pattern') && (f.confirmPassword.dirty || f.confirmPassword.touched)">
      La password no cumple la política.
    </small>
    <small class="error" *ngIf="form.hasError('passwordsDontMatch') && (f.confirmPassword.dirty || f.confirmPassword.touched)">
      Las contraseñas no coinciden.
    </small>
  </div>

  <!-- Email (debajo de las contraseñas, mismo ancho) -->
  <div class="form-field">
    <span class="p-float-label p-input-icon-right full">
      <i class="pi pi-envelope"></i>
      <input
        pInputText
        id="email"
        type="email"
        formControlName="email"
        autocomplete="email"
        [ngClass]="{'ng-invalid': f.email.invalid && (f.email.dirty || f.email.touched)}"
        class="w-full"
      />
      <label for="email">Email</label>
    </span>

    <small class="error" *ngIf="f.email.hasError('required') && (f.email.dirty || f.email.touched)">
      El email es obligatorio.
    </small>
    <small class="error" *ngIf="f.email.hasError('email') && (f.email.dirty || f.email.touched)">
      Formato de email no válido.
    </small>
    <small class="error" *ngIf="f.email.hasError('maxlength') && (f.email.dirty || f.email.touched)">
      Máximo 255 caracteres.
    </small>
  </div>

  <!-- Acepta Términos -->
  <div class="terms">
    <p-checkbox
      inputId="aceptaTerminos"
      formControlName="aceptaTerminos"
      [binary]="true"
    ></p-checkbox>
    <label for="aceptaTerminos">Acepto los Términos de uso</label>

    <small class="error" *ngIf="f.aceptaTerminos.hasError('required') && (f.aceptaTerminos.dirty || f.aceptaTerminos.touched)">
      Debes aceptar los términos para continuar.
    </small>

    <a href="">Términos de uso</a>
  </div>

  <!-- Botón -->
  <button
    pButton
    type="submit"
    label="Registrarse"
    class="big-black w-full"
    [disabled]="form.invalid"
  ></button>
</form>